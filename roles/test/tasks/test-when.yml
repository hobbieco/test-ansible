# roles/test/tasks/test-copy.yml

- name: test when - echo
  ansible.builtin.command:
    cmd: echo {{ test_when }}
  register: test_when

- name: test when - hostvars - equals
  ansible.builtin.command:
    cmd: echo {{ test_when }}
  when: test_when.stdout == hostvars[inventory_hostname]['test_when']

- name: test when - hostvars - not equals
  ansible.builtin.command:
    cmd: echo {{ test_when }}
  when: test_when.stdout != test_when

- name: test when - var name - equals
  ansible.builtin.command:
    cmd: echo {{ test_when }}
  when: test_when.stdout == test_str1|join(test_str2)

- name: test when - var name - not equals
  ansible.builtin.command:
    cmd: echo {{ test_when }}
  when: test_when.stdout != "test"|join(test_str2)

